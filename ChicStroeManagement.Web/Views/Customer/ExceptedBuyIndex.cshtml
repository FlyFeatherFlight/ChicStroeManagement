
@{
    Layout = null;
}

<!DOCTYPE html>
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<script src="~/Scripts/bootstrap.min.js"></script>
@model  List<ChicStoreManagement.WEB.ViewModel.CustomerExceptedBuyModel>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>预购信息</title>
    <script src="~/Scripts/jquery-3.0.0.js"></script>
    <script src="~/Scripts/jquery-3.0.0.min.js"></script>
    <script src="~/Scripts/jquery-ui-1.12.1.js"></script>
</head>
<body>
    
    <script>
        function edit(otr) {
            document.getElementById("edit").style.display = "block";
            var rows = otr.parentNode.parentNode.rowIndex;
            var id = $("#product tr:eq(" + rows + ") td:eq(0)").html();
            $("#editid").val(id);
            var receptionid = $("#product tr:eq(" + rows + ") td:eq(1)").html();
            var product = $("#product tr:eq(" + rows + ") td:eq(2)").html();
            var remarks = $("#product tr:eq(" + rows + ") td:eq(3)").html();
            $("#editreception").val(receptionid);
            $("#editproduct").val(product);
            $("#editremark").val(remarks);
        }
        function del(otr) {
            var rows = otr.parentNode.parentNode.rowIndex;
            var Id = $("#product tr:eq(" + rows + ") td:eq(0)").html();
            var receptionid = $("#product tr:eq(" + rows + ") td:eq(1)").html();
            $.ajax({
            type: "POST",
            url: '@Url.Action("DelExceptedBuyAction", "Customer")',
                data: { id: Id, receptionId: receptionid},
            datatype: "json",
            async: true,//异步
            success: function (data) {
                $('#products').html(data);
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(errorThrown);
            }

        });
        }
    </script>
    <div class="navbar navbar-inverse " id="fir">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                @Html.ActionLink("CHIC CASA", "Index", "Home", new { area = "" }, new { @class = "navbar-brand" })
            </div>
            <div class="navbar-collapse collapse" id="two">
                <ul class="nav navbar-nav">
                    <li>@Html.ActionLink("主页", "Index", "Home")</li>
                    @*<li>@Html.ActionLink("关于", "About", "Home")</li>
                    <li>@Html.ActionLink("联系方式", "Contact", "Home")</li>*@
                    <li>@Html.ActionLink("客户管理", "CustomerIndex", "Customer")</li>
                    <li>@Html.ActionLink("意向日志", "Contact", "Home")</li>
                    <li>@Html.ActionLink("设计日志", "Contact", "Home")</li>
                    <li id="logOut">@Html.ActionLink("注销", "SignOut", "LogIn")</li>

                </ul>
            </div>
        </div>

    </div>

    <div class="container body-content">
        <h3>@ViewBag.CustomerName 的预购信息</h3>
        <div class="table-responsive container">

            @Html.ActionLink("添加预购信息", "AddExceptedBuyView", new { receptionid = @ViewBag.receptionid, @class = "form-control", @Style = "font-size:12px" })
            <hr />
            <table id="product" class="table table-striped">
                <tr>
                    <th>接待单</th>
                    <th>商品型号</th>
                    <th>备注</th>
                    <th>操作</th>

                </tr>
                @foreach (var item in Model)
                {
                    <tr>
                        <td style="display:none">@item.ID</td>
                        <td>@item.接待</td>
                        <td>@item.商品型号</td>
                        <td>@item.备注</td>
                        <td><a href="javascript:;" onclick="edit(this)">编辑</a>|<a href="javascript:;" onclick="del(this)">删除</a></td>
                    </tr>
                }
            </table>

            <div id="edit" style="display:none" class="form-group">
                <h3>修改</h3>
                <form action="@Url.Action("UpdateExceptedBuyAction", "Customer")" method="POST">
                    Id:<input name="id" id="editid" class="form-control" readonly="readonly" />
                    接待id:<input name="接待" id="editreception" value="@ViewBag.receptionid" readonly="readonly" class="form-control" />
                    商品型号:@Html.DropDownList("型号", ViewBag.ProductOptions as IEnumerable<SelectListItem>, new { @class = "form-control" })
                    备注:<input name="备注" id="editremark" class="form-control" />
                    <button type="submit" class="btn">提交</button>
                </form>
                <hr />
            </div>
          
            <br />
            <a onclick="javascript:window.history.go(-1);" value="返回上一页">返回上一页</a>
            <hr />
        </div>

        <footer>
            <p>&copy; @DateTime.Now.Year -CHIC店面管理系统 by至尚至美信息部</p>
        </footer>
    </div>
   
</body>
</html>
